package layouts

import (
	"slices"

	"github.com/svuvi/theweek/models"
	"github.com/svuvi/theweek/components"
	"fmt"
)

templ Base(tabTitle string, metaTags templ.Component) {
	<!DOCTYPE html>
	<html lang="ru-RU">
		<head>
			<meta charset="UTF-8"/>
			<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
			<title>{ tabTitle }</title>
			<link rel="stylesheet" href="/static/style.css">
			<link rel="preconnect" href="https://fonts.googleapis.com">
			<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
			<link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
			<script src="/static/htmx.min.js"></script>
			<meta name="htmx-config" content='{"responseHandling": [{"code":".*", "swap": true}]}'/>
			/* –ò–∫–æ–Ω–∫–∏: */
			<link rel="icon" type="image/png" href="/static/favicon-96x96.png" sizes="96x96" />
			<link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
			<link rel="shortcut icon" href="/static/favicon.ico" />
			<link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png" />
			<meta name="apple-mobile-web-app-title" content="The Week" />
			<link rel="manifest" href="/static/site.webmanifest" />
			@metaTags
		</head>
		<body>
			{ children... }
		</body>
	</html>
}

templ Index(articles []*models.Article, authorized bool, user *models.User) {
	@Base("The Week - –ù–æ–≤–æ—Å—Ç–∏ –£—Ä–±–∞–Ω–æ–π–¥–∞", components.MetaTagsSite()) {
		@components.Header(user, false)
		<div class="content-feed">
			for _, art := range slices.Backward(articles) {
				@components.ArticleCard(art)
			}
		</div>
	}
}

templ Article(article *models.Article, authorized bool, user *models.User) {
	@Base(fmt.Sprint(article.Title, " - The Week"), components.MetaTagsArticle(article)) {
		@components.Header(user, false)
		if user.IsAdmin {
			<a class="button-1" href={ templ.SafeURL(fmt.Sprint("/dashboard/publishing/", article.ID)) }>üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
			<a class="button-1" href={ templ.SafeURL(fmt.Sprint("/delete/article/", article.ID)) } hx-confirm="–¢–æ—á–Ω–æ? –£–¥–∞–ª–µ–Ω–Ω—É—é —Å—Ç–∞—Ç—å—é –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
		}
		@components.Article(article)
	}
}

templ LoginPage(authorized bool, user *models.User) {
	@Base("–í—Ö–æ–¥ –≤ –ê–∫–∫–∞—É–Ω—Ç The Week", templ.NopComponent) {
		@components.Header(user, false)
		if !authorized {
			@components.LoginForm("", "", templ.NopComponent, templ.NopComponent)
		} else {
			<div class="inter-regular">
				<p>–í—ã —É–∂–µ –∑–∞—à–ª–∏ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç.</p>
				<a href="/logout" class="button-1">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.</a>
				<a href="/">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
			</div>
		}
	}
}

templ RegistrationPage() {
	@Base("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ê–∫–∫–∞—É–Ω—Ç–∞ –≤ The Week", templ.NopComponent) {
		@components.Header(&models.User{ID: 0}, false)
		@components.RegistrationForm("", "", "", templ.NopComponent, templ.NopComponent, templ.NopComponent)
	}
}

templ AlreadyRegisteredPage(user *models.User) {
	@Base("–í—ã —É–∂–µ –∑–∞—Ä–µ–≥–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ The Week", templ.NopComponent) {
		@components.Header(user, false)
		<div class="inter-regular">
			<p>–í—ã —É–∂–µ –∑–∞—Ä–µ–≥–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã.</p>
			<a href="/logout" class="button-1">–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.</a>
			<a href="/">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
		</div>
	}
}

templ RegistrationNoInvite(expired bool) {
	@Base("–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –≤ The Week", templ.NopComponent) {
		@components.Header(&models.User{ID: 0}, false)
		<h1>–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –≤ The Week</h1>
		if expired {
			<p>–ü–æ—Ö–æ–∂–µ, —á—Ç–æ —Ç—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Å—Å—ã–ª–∫–æ–π –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º. –ù–æ —ç—Ç–∞ —Å—Å—ã–ª–∫–∞ —É–∂–µ –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞</p>
		}
		<ol>
			<li>–ù–∞–ø–∏—à–∏ –≤ —á–∞—Ç–µ —É—Ä–±–∞–Ω–æ–π–¥–æ–≤, —á—Ç–æ —Ö–æ—á–µ—à—å –∞–∫–∫–∞—É–Ω—Ç –≤ The Week</li>
			<li>–¢–µ–±–µ –ø—Ä–∏—à–ª—é—Ç —Å—Å—ã–ª–∫—É —Å –∫–æ–¥–æ–º-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</li>
			<li>–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è —á–µ—Ä–µ–∑ —ç—Ç—É —Å—Å—ã–ª–∫—É. </li>
		</ol>
		<p>–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –ü–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É, —Ç–µ–±–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–æ–±—Ä–µ–Ω–æ –ø—Ä–∞–≤–æ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–≤–æ–∏ –∑–∞–º–µ—Ç–∫–∏.</p>
		<p>–°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è–º –∑–∞—â–∏—â–∞–µ—Ç The Week –æ—Ç –Ω–µ–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö –≥–æ—Å—Ç–µ–π, –Ω–µ –∏–º–µ—é—â–∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –Ω–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É.</p>
	}
}
